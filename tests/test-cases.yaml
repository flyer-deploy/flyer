- config: []
  env:
    - value: []
      expected:
        exception:
          class: Deployer\Exception\ConfigurationException
          message: Please specify APP_ID environment variable

    - value:
        APP_ID: app_id
      expected:
        exception:
          class: Deployer\Exception\ConfigurationException
          message: Please specify ARTIFACT_FILE environment variable

    - value:
        APP_ID: app_id
        ARTIFACT_FILE:
      expected:
        exception:
          class: Deployer\Exception\ConfigurationException
          message: Please specify DEPLOY_PATH environment variable

    - value:
        APP_ID: app_id
        ARTIFACT_FILE:
        # arbitrary file
        DEPLOY_PATH: /etc/passwd
      expected:
        exception:
          class: Deployer\Exception\Exception
          message:
            regex_match: Deploy path .+? is a regular file, not an existing or a non-existent directory

    - value:
        APP_ID: app_id
        ARTIFACT_FILE:
        DEPLOY_PATH:
      expected:
        result:
          type: task_done_successfully
          params:
            task_name: deploy
- config:
    additional:
      files:
        - .env
  env:
    - value:
        APP_ID: app_id
        ARTIFACT_FILE:
        DEPLOY_PATH:
        ADDITIONAL_FILES_DIR: /tmp
      expected:
        result:
          type: task_done_successfully
          params:
            task_name: deploy

    - value:
        APP_ID: app_id
        ARTIFACT_FILE:
        DEPLOY_PATH:
      expected:
        exception:
          class: Deployer\Exception\Exception
          message: >-
            ADDITIONAL_FILES_DIR is not specified while the configuration flyer.yaml did.
